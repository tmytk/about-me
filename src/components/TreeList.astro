---
const {
  items = [],
  emptyMessage = "No entries.",
  title = "",
  titleHref = "",
  showDesc = true,
} = Astro.props;
const hasItems = items.length > 0;
---

<section class="section" data-section>
  {title ? (
    <h2>
      {titleHref ? <a href={titleHref}>{title}</a> : title}
    </h2>
  ) : null}
  <div class="cards">
    {hasItems
      ? items.map((item) => (
          <>
            <a
              class={`card${item.isFolder ? " folder" : ""}`}
              href={item.href}
              data-title={item.title}
            >
              <div class="item">
                {!item.isFolder ? (
                  <span class="bullet" aria-hidden="true">•</span>
                ) : null}
                <div class="text">
                  <div class="title-row">
                    <h3 class="title">
                      <span class="title-text">{item.title}</span>
                    </h3>
                    {item.date ? <span class="date">{item.date}</span> : null}
                  </div>
                  {showDesc && item.desc ? <p class="muted">{item.desc}</p> : null}
                </div>
              </div>
            </a>
            {item.children?.length ? (
              <div class="children">
                {item.children.map((child) => (
                  <a
                    class={`card child${child.isFolder ? " folder" : ""}`}
                    href={child.href}
                    data-title={child.title}
                  >
                    <div class="item">
                      {!child.isFolder ? (
                        <span class="bullet" aria-hidden="true">•</span>
                      ) : null}
                      <div class="text">
                        <div class="title-row">
                          <h3 class="title">
                            <span class="title-text">{child.title}</span>
                          </h3>
                          {child.date ? (
                            <span class="date">{child.date}</span>
                          ) : null}
                        </div>
                        {showDesc && child.desc ? (
                          <p class="muted">{child.desc}</p>
                        ) : null}
                      </div>
                    </div>
                  </a>
                ))}
              </div>
            ) : null}
          </>
        ))
      : null}
    <p class={`empty ${hasItems ? "hidden" : ""}`} data-empty>
      {emptyMessage}
    </p>
  </div>
</section>

<style>
  .section h2 {
    font-size: 18px;
    margin-bottom: 4px;
    font-weight: 400;
    font-family:
      "Helvetica Neue", "Arial", "Hiragino Kaku Gothic ProN", "Hiragino Sans",
      "Yu Gothic", "Meiryo", sans-serif;
  }

  .section h2 a {
    color: inherit;
    text-decoration: none;
  }

  .section h2 a:hover {
    text-decoration: underline;
    text-decoration-thickness: 1px;
    text-underline-offset: 2px;
  }

  .cards {
    display: grid;
    gap: 4px;
  }

  .card {
    display: grid;
    gap: 0;
    padding: 4px 0 4px 16px;
    border: none;
    border-radius: 0;
    background: transparent;
    text-decoration: none;
    color: inherit;
  }

  .card:hover .title-text {
    text-decoration: underline;
    text-decoration-thickness: 1px;
    text-underline-offset: 2px;
  }

  .card.child {
    padding-left: 16px;
  }

  .children {
    display: grid;
    gap: 4px;
    padding-left: 16px;
  }

  .item {
    display: grid;
    grid-template-columns: 10px 1fr;
    column-gap: 6px;
    align-items: baseline;
  }

  .card.folder .item {
    grid-template-columns: 0 1fr;
    column-gap: 0;
  }

  .text {
    display: grid;
    gap: 0;
  }

  .title-row {
    display: flex;
    align-items: baseline;
    justify-content: space-between;
    gap: 12px;
  }

  .title {
    margin: 0;
    font-size: 16px;
    font-weight: 500;
  }

  .card.folder {
    font-family:
      "Helvetica Neue", "Arial", "Hiragino Kaku Gothic ProN", "Hiragino Sans",
      "Yu Gothic", "Meiryo", sans-serif;
  }

  .card.folder .title {
    font-family:
      "Helvetica Neue", "Arial", "Hiragino Kaku Gothic ProN", "Hiragino Sans",
      "Yu Gothic", "Meiryo", sans-serif;
    font-size: 18px;
    font-weight: 400;
  }

  .bullet {
    width: 10px;
    text-align: center;
    line-height: 1;
    margin-top: 2px;
  }

  .muted {
    color: #5b5b5b;
    font-size: 12px;
    margin: 0;
  }

  .date {
    font-size: 12px;
    color: #616161;
    white-space: nowrap;
  }

  .empty {
    color: #6b6b6b;
    font-size: 14px;
  }

  .empty.hidden {
    display: none;
  }
</style>
